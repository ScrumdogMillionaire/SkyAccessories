<!DOCTYPE html>

{%  load static from staticfiles %}

<html lang="en">

<head>

	<meta charset="utf-8">
	<title>{% block title %}{% endblock %}</title>

	<!-- CSS -->
	<link rel="stylesheet" href="{% static 'css/materialize.css' %}">
	<link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

	<!-- Google Icons -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{%  static 'assets/Sky_logo-2.png' %}">

</head>

<body>

    <!-- NavBar -->
	<header>
		<div class="navbar-fixed">
            {% if user.is_staff %}
                <!-- Non-Staff Dropdown Structure -->
                <ul id="dropdown1" class="dropdown-content z-depth-0">
                    <li><a href="/skystore/adminpage/" class="blue-grey-text text-darken-4"><h6>Admin Page</h6></a></li>
                    <li><a href="/skystore/accountsettings/" class="blue-grey-text text-darken-4"><h6>My Account</h6></a></li>
                    <li><a href="/skystore/logout/" class="blue-grey-text text-darken-4"><h6>Sign Out</h6></a></li>
                </ul>
            {% else %}
                <!-- Staff Dropdown Structure -->
                <ul id="dropdown1" class="dropdown-content z-depth-0">
                    <li><a href="/skystore/accountsettings/" class="blue-grey-text text-darken-4"><h6>My Account</h6></a></li>
                    <li><a href="/skystore/logout/" class="blue-grey-text text-darken-4"><h6>Sign Out</h6></a></li>
                </ul>
            {% endif %}


			<nav class="z-depth-0 white" role="navigation">
				<div class="nav-wrapper container">

					<!-- Sky Home Button-->

					<a href="/skystore/" class="brand-logo center"><img class="logo-header" src="{%  static 'assets/logo1.png' %}"/></a>

					<!-- Menu Icon-->

					<a href="#" data-activates="side-menu" class="button-collapse tooltipped" data-position="right" data-tooltip="Menu"><i class="material-icons prefix blue-grey-text text-darken-4">menu</i></a>

					<!-- Navigation on the right -->

					<ul class="right hide-on-med-and-down">

						<li>
							<!-- Search -->
							<a id="search-button" href="#" class="blue-grey-text text-darken-4">
								<i class="material-icons blue-grey-text text-darken-4 right">search</i>
								Search
							</a>
						</li>

						{% if request.user.is_authenticated %}
						<li>
							<!-- Account Dropdown -->
							<a class="dropdown-button blue-grey-text text-darken-4" data-activates="dropdown1" data-beloworigin="true" data-hover="true">
								<!-- <i class="material-icons grey-text left">perm_identity</i> -->
								<i class="material-icons blue-grey-text text-darken-4 right">arrow_drop_down</i>
								{{ request.user.username }}
							</a>
						</li>
						{% else %}
						<li>
							<!-- Sign In -->
							<a href="/skystore/login/" class="blue-grey-text text-darken-4">
								<i class="material-icons blue-grey-text text-darken-4 right">perm_identity</i>
								Sign In
							</a>
						</li>
						{% endif %}

						<li>
							<!-- Shopping Cart -->
							<a href="/skystore/basket/" class="blue-grey-text text-darken-4">
								<i class="material-icons blue-grey-text text-darken-4 right">shopping_cart</i>
								{%if request.session.basket == None%}
								<span id="basket_number">Basket (0)</span>
								{% else %}
								<span id="basket_number">Basket ({{request.session.basket|length}})</span>
								{% endif %}
							</a>
						</li>
					</ul>

					<!-- Side Navigation-->

					<ul class="side-nav" id="side-menu">
                        <li class="no-padding">

                            <ul class="collapsible" data-collapsible="accordion">

                                <li class="bold">
                                    <a class="collapsible-header bold">Categories</a>
                                    <div class="collapsible-body">
                                        <ul>
                                            <li>
                                                <a href="/skystore/search/?search=Children">Children</a>
                                            </li>
                                            <li>
                                                <a href="/skystore/search/?search=Women">Women</a>
                                            </li>
                                            <li>
                                                <a href="/skystore/search/?search=Men">Men</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>

                            </ul>
                        </li>

                        <li>
                            <a id="search-buttn" href="#" class="blue-grey-text text-darken-4">
                                Search
                            </a>
                        </li>
                        {% if request.user.is_authenticated %}
                            <li><a href="/skystore/accountsettings/" class="blue-grey-text text-darken-4">My Account</a></li>
                        {%  else %}
                            <li><a href="/skystore/login/" class="blue-grey-text text-darken-4">Sign In</a></li>
                        {% endif %}
                        <li><a href="/skystore/basket/" class="blue-grey-text text-darken-4">Basket</a></li>

                    </ul>
				</div>
			</nav>
		</div>


	</header>

    <!-- CONTENT -->
    <main class="blue-grey lighten-5">
		<div id="main_content" class="container">
			<div id="drop-search" class="blue-grey darken-4">
				
					<form action="/skystore/search/" method="GET">
						<input id="search" name="search" class="white-text" type="search" autocomplete="off" placeholder="Search..." required>
					</form>
				
			</div>

			<div id="top-spacer"></div>
                {% block body_block %}

                {% endblock %}
		</div>
	</main>

    <!-- Footer -->
	<footer class="page-footer">
		<div class="footer-copyright white">
			<div class="container grey-text">
				Â© 2015 Sky UK
				<a class="grey-text right" href="#!">Terms & Conditions</a>
			</div>
		</div>
	</footer>

	<!-- JavaScript/jQuery Includes -->
	<script src="{%  static 'js/jquery-2.1.4.js' %}"></script>
    <script src="{%  static 'js/jquery-ui.js' %}"></script>
	<script src="{%  static 'js/materialize.js' %}"></script>
	<script src="{%  static 'js/masonry.pkgd.min.js'%}"></script>
	<script src="{%  static 'js/jquery.nested.js'%}"></script>

    <!-- Javascrit -->
	<script type="text/javascript">
        $( document ).ready(function(){
            $(".button-collapse").sideNav();
        })

        $('.grid').masonry({
		    // options
		    itemSelector: '.grid-item',
		    columnWidth: 320,
		    gutter: 10,
		    isFitWidth: true
	    });

		$('.addbasket').click(function(){
			$.ajax({

				url: "/skystore/addtobasket/",
				type: 'POST',
				dataType: "json",
				data: {'id': $(this).attr('name'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
				success: function(response) {
                      result = response.number_of_products;
					$("#basket_number").text('Basket ('+result+')');
					Materialize.toast(response.product_name+' added to basket', 3000);
                },
				error: function(rs, e) {
                       alert(rs.responseText);
                }


			});
		});

		$(document).ready(function(){

			var status = 0;

			//Navigation Top Right
		    $("#search-button").click(function(){

		    	if(status == 0)
		    	{
		    		$("#drop-search").slideDown();
		    		$("#search").focus();
		    		status = 1;
		    	}
		    	else if(status == 1)
		    	{
		    		$("#drop-search").slideUp();
		    		status = 0;
		    	}   
		    });

		    //Side Nav
		    $("#search-buttn").click(function(){

		    	if(status == 0)
		    	{
		    		$("#drop-search").slideDown();
		    		$("#search").focus();
		    		status = 1;
		    	}
		    	else if(status == 1)
		    	{
		    		$("#drop-search").slideUp();
		    		status = 0;
		    	}   
		    });

		});

	</script>

{#	<script>#}
{#  window.intercomSettings = { app_id: 'thkb07zh' };#}
{#</script>#}
{#<!-- Replace 'APP_ID' with your app ID -->#}
{#<script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/APP_ID';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>#}

</body>
</html>
